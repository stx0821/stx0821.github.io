---
title: JavaScript 匿名函数自执行的写法与探究
tags:
  - JavaScript
id: 108
categories:
  - WEB技术
date: 2016-06-07 22:58:58
---

首先是正常的匿名函数自执行写法，也是最为常见的写法。
<!--more-->
<pre>(function(){
	alert(1);
})();
</pre>
还有通过各种运算符来将函数表达式执行并返回的，当然也可以不返回，函数照样执行。
<pre>!function(){
	alert(1);
}();

-function(){
	return 1;
}();

typeof function(){
	return 1;
}();

1 &amp;&amp; function(){
	return 1;
}();
</pre>
下面这种写法则是在最外层包了个`()`，这里的`()`是提升优先级，虽然只有一个表达式，但是加上`()`也不会有什么错，而且达到了自执行的效果。
<pre>(function(){
	alert(1);
}());
</pre>
下面这种更让人感觉疑惑，最外层包了个`[]`，看起来就像是一个没有被赋值的数组字面量，居然也自我执行了。不错，确实数组字面量，数组字面量里要求填入的就是合法表达式（包括字面量、基本数据类型等等）。
<pre>[function(){
	alert(1);
}()];
</pre>
** 总结：通过以上探究，我们会发现`function(){}()`直接写肯定会报错，浏览器并不会把它当一个表达式执行，但如果是当它处在其它表达式的位置的时候就不会报错，而且函数会自我执行。 **

一个实际的例子。
<pre>var currentDate = {
	date:(function(){
		var d = new Date();
		return d.getDate();
	})()
};
</pre>
根据之前的总结，只要`function(){}()`是处在表达式的位置上，就不会报错而且会自执行，所以改写成如下，直接去掉`()`。
<pre>var currentDate = {
	date:function(){
		var d = new Date();
		return d.getDate();
	}()
};
</pre>